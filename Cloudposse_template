resource "google_privateca_certificate_template" "this" {
  location = var.location
  name     = "projects/${var.project}/locations/${var.location}/certificateTemplates/${var.template_name}"

  object_id {
    object_id_path    = var.object_id_path
    description       = var.object_id_description
  }

  description = var.template_description

  identity_constraints {
    allow_subject_alt_names_passthrough = var.allow_subject_alt_names_passthrough
    allow_subject_passthrough          = var.allow_subject_passthrough

    cel_expression {
      description = var.cel_expression_description
    }
  }

  passthrough_extensions {
    additional_extensions = var.passthrough_extensions_additional_extensions
    known_extensions      = var.passthrough_extensions_known_extensions
  }

  predefined_values {
    additional_extensions = var.predefined_values_additional_extensions

    aia_ocsp_servers {
      ocsp_urls = var.predefined_values_aia_ocsp_servers_ocsp_urls
    }

    ca_options {
      is_ca                = var.predefined_values_ca_options_is_ca
      max_issuer_path_length = var.predefined_values_ca_options_max_issuer_path_length
    }

    key_usage {
      base_key_usage = var.predefined_values_key_usage_base_key_usage

      extended_key_usage = var.predefined_values_key_usage_extended_key_usage

      unknown_extended_key_usages {
        object_id_path = var.predefined_values_key_usage_unknown_extended_key_usages_object_id_path
      }
    }

    policy_ids {
      object_id_path = var.predefined_values_policy_ids_object_id_path
    }
  }

  project = var.project
}

variable "location" {
  description = "The location for the resource"
  type        = string
}

variable "template_name" {
  description = "The name of the certificate template"
  type        = string
}

variable "object_id_path" {
  description = "The parts of an OID path for object_id"
  type        = string
}

variable "object_id_description" {
  description = "Description for object_id"
  type        = string
}

variable "template_description" {
  description = "Description for the certificate template"
  type        = string
  default     = "Default template description"
}

variable "allow_subject_alt_names_passthrough" {
  description = "Allow SubjectAltNames extension to be copied from request"
  type        = bool
}

variable "allow_subject_passthrough" {
  description = "Allow Subject field to be copied from request"
  type        = bool
}

variable "cel_expression_description" {
  description = "Description for cel_expression"
  type        = string
}

variable "project" {
  description = "The project for the resource"
  type        = string
}

variable "passthrough_extensions_additional_extensions" {
  type    = list(string)
  default = []
}

variable "passthrough_extensions_known_extensions" {
  type    = list(string)
  default = []
}

variable "predefined_values_additional_extensions" {
  type    = list(string)
  default = []
}

variable "predefined_values_aia_ocsp_servers_ocsp_urls" {
  type    = list(string)
  default = []
}

variable "predefined_values_ca_options_is_ca" {
  type    = bool
  default = false
}

variable "predefined_values_ca_options_max_issuer_path_length" {
  type    = number
  default = -1
}

variable "predefined_values_key_usage_base_key_usage" {
  type    = list(string)
  default = []
}

variable "predefined_values_key_usage_extended_key_usage" {
  type    = list(string)
  default = []
}

variable "predefined_values_key_usage_unknown_extended_key_usages_object_id_path" {
  type    = string
  default = ""
}

variable "predefined_values_policy_ids_object_id_path" {
  type    = string
  default = ""
}

